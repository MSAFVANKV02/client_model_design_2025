import{j as e,a as g}from"./vendor-Dyml7b79.js";import{z as j,d as S,e as O,t as P,F as T,f as I,g as E,h as k,i as C,m as c,B as F,j as h,L as v,k as R}from"./index-B6i9YlCS.js";import{P as _}from"./style-CPrzcRgE.js";import{_ as L}from"./ClipLoader-D-FKsc_Y.js";import{r as d}from"./react-rGsIzOq1.js";import{I as U,a as A,b as M,O as G}from"./otp-timer-CggaT8g_.js";import{U as z,R as $,S as q}from"./urlPath-7qCOueyb.js";import{A as V}from"./arrow-left-DSrZCQXP.js";import"./createLucideIcon-cTz5pK2-.js";const B=j.object({otp:j.string().min(6,{message:"OTP is required."})});function Y({setShowOtpLogin:n,setMessage:f}){const l=S(),[p,m]=d.useState(!1),x=O({resolver:P(B),defaultValues:{otp:""}}),u=new URLSearchParams(window.location.search).get("auth"),w=async r=>{var i,t,o,a;try{const s=await g.post(z,{otp:r.otp,mobile:u});s.status===200&&s.data.success&&s.data.user&&(localStorage.setItem("otp-timer","0"),s.data.user.kycApproved&&s.data.user.kycsubmitted?c("Otp Verified Successfully."):s.data.user.isVerified&&s.data.user.isRegistered&&!s.data.user.kycsubmitted?(c("Complete Kyc registration.."),l("/kyc")):s.data.user.isVerified&&!s.data.user.isRegistered?(c("Register your account..."),l(`/register/user-details?auth=${u}`),n(!1)):(c("Your account is under Processing...."),f("Your account is under Processing"),l("/kyc")))}catch(s){m(!1),console.log(s),g.isAxiosError(s)&&(((i=s.response)==null?void 0:i.status)===500?h((t=s.response)==null?void 0:t.data.message):(o=s.response)!=null&&o.data?h((a=s.response)==null?void 0:a.data.message):h("An error occurred."))}},N=async()=>{var r,i;try{m(!0),(await g.post($,{mobile:u})).status===200&&c("OTP Resent Successfully")}catch(t){m(!1),g.isAxiosError(t)?((r=t.response)==null?void 0:r.data.success)===!1&&h((i=t.response)==null?void 0:i.data.message):console.log("Unexpected error:",t)}finally{m(!1)}};return e.jsxs("div",{className:"w-full lg:w-1/2 p-8 relative bg-[#F5E9FF] flex flex-col justify-center items-center",children:[e.jsx(V,{onClick:()=>{n(!1),localStorage.removeItem("otp-timer"),localStorage.removeItem("otp-finished"),l("/login")},className:"absolute top-4 left-4 cursor-pointer text-textMain",fontSize:20}),e.jsx("img",{src:"/img/Background Images/Group 1117.png",alt:"logo",className:"w-36 mb-4"}),e.jsx("p",{className:"font-extrabold text-2xl mb-2",children:"Verify Mobile Number"}),e.jsxs("p",{className:"text-gray-500 text-center sm:px-11 px-5 mb-6",children:["Enter 6 digit verification code sent to"," ",e.jsx("b",{className:"text-black",children:"Mobile Number"})]}),e.jsx(T,{...x,children:e.jsxs("form",{onSubmit:x.handleSubmit(w),className:"space-y-4",children:[e.jsx(I,{control:x.control,name:"otp",render:({field:r})=>e.jsxs(E,{children:[e.jsx(k,{children:e.jsx(U,{maxLength:6,value:r.value,onChange:r.onChange,children:e.jsx(A,{className:"space-x-2 rounded-xl",children:[...Array(6)].map((i,t)=>e.jsx(M,{index:t,className:"border text-center text-xl rounded-xl bg-white border-gray-300",onChange:o=>{const s=o.target.value;r.onChange(s)}},t))})})}),e.jsx(C,{})]})}),e.jsx(G,{resendOtp:N,initialTime:60,onTimerFinish:()=>c("You can resend OTP now.")}),e.jsx(F,{type:"submit",disabled:p,variant:"b2bStyle",size:"b2b",className:"w-full",children:p?e.jsx(L,{color:"#ffff",size:20}):"Get Verification Code"})]})})]})}const D=async n=>await g.post(q,{mobile:n}),H=j.object({mobile:j.string().min(13,{message:"Phone number must be exactly 10 digits."}),mobile4OTP:j.string().min(1,{message:"Mobile number is required."})});function re(){const n=S(),[f,l]=d.useState(!1),[p,m]=d.useState(""),[x,y]=d.useState(!1),u=new URLSearchParams(window.location.search),w=u.get("auth"),N=u.get("page");d.useEffect(()=>{N==="otp-log"&&w&&y(!0)},[w,N]),d.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);const r=O({resolver:P(H),defaultValues:{mobile:"+91 7034359330",mobile4OTP:"7034359330"}}),i=async t=>{var o,a;try{l(!0),(await D(t.mobile4OTP)).status===200&&(c(`Otp Sended to ${t.mobile4OTP}`),y(!0),n(`/login?page=otp-log&auth=${t.mobile4OTP}`),localStorage.setItem("otp-timer","60"),localStorage.removeItem("otp-finished"))}catch(s){l(!1),g.isAxiosError(s)?((o=s.response)==null?void 0:o.data.success)===!1&&h((a=s.response)==null?void 0:a.data.message):console.log("Unexpected error:",s)}finally{l(!1)}};return e.jsxs("div",{className:"h-screen w-screen flex items-center justify-center relative",children:[e.jsx("img",{src:"/img/Background Images/Group 1109.svg",alt:"",draggable:!1,className:"absolute w-full h-full object-cover"}),e.jsxs("div",{className:"flex flex-col mx-3 lg:flex-row w-full lg:max-w-4xl sm:max-w-[60%] max-w-[90%] h-auto bg-white shadow-lg rounded-3xl overflow-hidden",children:[e.jsx("div",{className:"hidden lg:block lg:w-3/4 relative",children:e.jsx("img",{src:"/img/Hero Images/login_main.png",alt:"login",draggable:!1,className:"w-full h-full object-cover"})}),x?e.jsx(Y,{setShowOtpLogin:y,setMessage:m}):e.jsxs("div",{className:"w-full lg:w-1/2 p-8 relative bg-[#F5E9FF] flex flex-col justify-center items-center",children:[e.jsx(V,{onClick:()=>n("/"),className:"absolute top-4 left-4 cursor-pointer"}),e.jsx("img",{src:"/img/Background Images/Group 1107.png",alt:"logo",className:"w-28 h-28 mb-4"}),e.jsx("p",{className:"font-bold text-xl mb-2",children:"Enter Mobile Number"}),p?e.jsxs("div",{className:"text-xs bg-green-100 p-2 rounded-md w-full my-3",children:[p," ",e.jsx(v,{to:"/",className:"text-blue-500 underline",children:"Visit Our Home"})]}):e.jsx("p",{className:"text-gray-500 text-center mb-6",children:"Enter your 10-digit mobile number to receive the verification code."}),e.jsx(T,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(i),className:"w-full space-y-6",children:[e.jsx(I,{control:r.control,name:"mobile",render:({field:t})=>e.jsxs(E,{children:[e.jsx(R,{className:"mb-2",children:"Mobile Number"}),e.jsx(k,{children:e.jsx(_,{country:"in",preferredCountries:["in","us","sa","ae"],enableSearch:!0,placeholder:"Valid mobile number",value:t.value,inputStyle:{width:"100%"},buttonStyle:{backgroundColor:"transparent",border:"none"},onChange:(o,a)=>{const s=(a==null?void 0:a.dialCode)||"";let b=o;b.startsWith(s)&&(b=b.slice(s.length)),r.setValue("mobile",`${s}-${b}`),r.setValue("mobile4OTP",b)},inputClass:"w-full p-6 border border-gray-300  rounded"})}),e.jsx(C,{})]})}),e.jsx(F,{type:"submit",disabled:f,variant:"b2bStyle",className:"w-full",size:"b2b",children:f?e.jsx(L,{color:"#ffff",size:20}):" Get Verification Code"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["If you don't have an account,"," ",e.jsx(v,{to:"/register",className:"text-textMain",children:"register here"})]})]})})]})]})]})}export{re as default};
