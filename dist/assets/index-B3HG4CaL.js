import{r as i}from"./react-rGsIzOq1.js";import{a7 as M,o as g,l as p}from"./index-B6NST0oS.js";function I(n,e,{checkForDefaultPrevented:o=!0}={}){return function(r){if(n==null||n(r),o===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function v({prop:n,defaultProp:e,onChange:o=()=>{}}){const[t,r]=T({defaultProp:e,onChange:o}),a=n!==void 0,l=a?n:t,m=M(o),c=i.useCallback(s=>{if(a){const u=typeof s=="function"?s(n):s;u!==n&&m(u)}else r(s)},[a,n,r,m]);return[l,c]}function T({defaultProp:n,onChange:e}){const o=i.useState(n),[t]=o,r=i.useRef(t),a=M(e);return i.useEffect(()=>{r.current!==t&&(a(t),r.current=t)},[t,r,a]),o}function h(n,e){return i.useReducer((o,t)=>e[o][t]??o,n)}var S=n=>{const{present:e,children:o}=n,t=U(e),r=typeof o=="function"?o({present:t.isPresent}):i.Children.only(o),a=g(t.ref,C(r));return typeof o=="function"||t.isPresent?i.cloneElement(r,{ref:a}):null};S.displayName="Presence";function U(n){const[e,o]=i.useState(),t=i.useRef({}),r=i.useRef(n),a=i.useRef("none"),l=n?"mounted":"unmounted",[m,c]=h(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return i.useEffect(()=>{const s=A(t.current);a.current=m==="mounted"?s:"none"},[m]),p(()=>{const s=t.current,d=r.current;if(d!==n){const N=a.current,f=A(s);n?c("MOUNT"):f==="none"||(s==null?void 0:s.display)==="none"?c("UNMOUNT"):c(d&&N!==f?"ANIMATION_OUT":"UNMOUNT"),r.current=n}},[n,c]),p(()=>{if(e){let s;const d=e.ownerDocument.defaultView??window,u=f=>{const P=A(t.current).includes(f.animationName);if(f.target===e&&P&&(c("ANIMATION_END"),!r.current)){const R=e.style.animationFillMode;e.style.animationFillMode="forwards",s=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=R)})}},N=f=>{f.target===e&&(a.current=A(t.current))};return e.addEventListener("animationstart",N),e.addEventListener("animationcancel",u),e.addEventListener("animationend",u),()=>{d.clearTimeout(s),e.removeEventListener("animationstart",N),e.removeEventListener("animationcancel",u),e.removeEventListener("animationend",u)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(m),ref:i.useCallback(s=>{s&&(t.current=getComputedStyle(s)),o(s)},[])}}function A(n){return(n==null?void 0:n.animationName)||"none"}function C(n){var t,r;let e=(t=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:t.get,o=e&&"isReactWarning"in e&&e.isReactWarning;return o?n.ref:(e=(r=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:r.get,o=e&&"isReactWarning"in e&&e.isReactWarning,o?n.props.ref:n.props.ref||n.ref)}export{S as P,I as c,v as u};
