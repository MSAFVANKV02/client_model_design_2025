import{j as e,a as p}from"./vendor-Dyml7b79.js";import{z as h,d as v,e as S,t as O,L as P,F as T,f as E,g as C,h as I,i as F,m as c,B as L,j as b,k as R}from"./index-CYux8Zly.js";import{P as _}from"./style-CPrzcRgE.js";import{_ as V}from"./ClipLoader-D-FKsc_Y.js";import{r as x}from"./react-rGsIzOq1.js";import{I as U,a as A,b as M,O as G}from"./otp-timer-CbUiICIC.js";import{U as z,R as $,b as q}from"./urlPath-B8wF3stT.js";import{A as k}from"./arrow-left-DSrZCQXP.js";import"./createLucideIcon-cTz5pK2-.js";const B=h.object({otp:h.string().min(6,{message:"OTP is required."})});function Y({setShowOtpLogin:m}){const l=v(),[u,d]=x.useState(!1),[g,j]=x.useState(""),f=S({resolver:O(B),defaultValues:{otp:""}}),i=new URLSearchParams(window.location.search).get("auth"),y=async r=>{var a,t,o,N;try{const s=await p.post(z,{otp:r.otp,mobile:i});console.log(s.data),s.status===200&&s.data.success&&s.data.user&&(s.data.user.isVerified&&s.data.user.isRegistered&&s.data.user.isKycCompleted&&s.data.user.kycApproved?(c("Otp Verified Successfully."),l("/"),window.location.reload()):s.data.user.isVerified&&s.data.user.isRegistered&&!s.data.user.isKycCompleted?(c("Complete Kyc registration.."),l("/kyc")):s.data.user.isVerified&&!s.data.user.isRegistered?(c("Your account is under Processing...."),l(`/register/user-details?auth=${i}`)):(c("Your account is under Processing...."),j("Your account is under Processing")))}catch(s){d(!1),console.log(s),p.isAxiosError(s)&&(((a=s.response)==null?void 0:a.status)===500?b((t=s.response)==null?void 0:t.data.message):(o=s.response)!=null&&o.data?b((N=s.response)==null?void 0:N.data.message):b("An error occurred."))}},n=async()=>{var r,a;try{d(!0),(await p.post($,{mobile:i})).status===200&&c("OTP Resent Successfully")}catch(t){d(!1),p.isAxiosError(t)?((r=t.response)==null?void 0:r.data.success)===!1&&b((a=t.response)==null?void 0:a.data.message):console.log("Unexpected error:",t)}finally{d(!1)}};return e.jsxs("div",{className:"w-full lg:w-1/2 p-8 relative bg-[#F5E9FF] flex flex-col justify-center items-center",children:[e.jsx(k,{onClick:()=>{m(!1),localStorage.removeItem("otp-timer"),localStorage.removeItem("otp-finished"),l("/login")},className:"absolute top-4 left-4 cursor-pointer text-textMain",fontSize:20}),e.jsx("img",{src:"/img/Background Images/Group 1117.png",alt:"logo",className:"w-36 mb-4"}),e.jsx("p",{className:"font-extrabold text-2xl mb-2",children:"Verify Mobile Number"}),e.jsxs("p",{className:"text-gray-500 text-center sm:px-11 px-5 mb-6",children:["Enter 6 digit verification code sent to"," ",e.jsx("b",{className:"text-black",children:"Mobile Number"})]}),g&&e.jsxs("p",{className:"text-xs bg-green-100 p-2 rounded-md",children:[g," ",e.jsx(P,{to:"/",className:"text-blue-500 underline",children:"Visit Our Home"})]}),e.jsx(T,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(y),className:"space-y-4",children:[e.jsx(E,{control:f.control,name:"otp",render:({field:r})=>e.jsxs(C,{children:[e.jsx(I,{children:e.jsx(U,{maxLength:6,value:r.value,onChange:r.onChange,children:e.jsx(A,{className:"space-x-2 rounded-xl",children:[...Array(6)].map((a,t)=>e.jsx(M,{index:t,className:"border text-center text-xl rounded-xl bg-white border-gray-300",onChange:o=>{const s=o.target.value;r.onChange(s)}},t))})})}),e.jsx(F,{})]})}),e.jsx(G,{resendOtp:n,initialTime:60,onTimerFinish:()=>c("You can resend OTP now.")}),e.jsx(L,{type:"submit",disabled:u,variant:"b2bStyle",size:"b2b",className:"w-full",children:u?e.jsx(V,{color:"#ffff",size:20}):"Get Verification Code"})]})})]})}const K=async m=>await p.post(q,{mobile:m}),D=h.object({mobile:h.string().min(13,{message:"Phone number must be exactly 10 digits."}),mobile4OTP:h.string().min(1,{message:"Mobile number is required."})});function re(){const m=v(),[l,u]=x.useState(!1),[d,g]=x.useState(!1),j=new URLSearchParams(window.location.search),f=j.get("auth"),w=j.get("page");x.useEffect(()=>{w==="otp-log"&&f&&g(!0)},[f,w]),x.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);const i=S({resolver:O(D),defaultValues:{mobile:"",mobile4OTP:""}}),y=async n=>{var r,a;try{u(!0),(await K(n.mobile4OTP)).status===200&&(c(`Otp Sended to ${n.mobile4OTP}`),g(!0),m(`/login?page=otp-log&auth=${n.mobile4OTP}`))}catch(t){u(!1),p.isAxiosError(t)?((r=t.response)==null?void 0:r.data.success)===!1&&b((a=t.response)==null?void 0:a.data.message):console.log("Unexpected error:",t)}finally{u(!1)}};return e.jsxs("div",{className:"h-screen w-screen flex items-center justify-center relative",children:[e.jsx("img",{src:"/img/Background Images/Group 1109.svg",alt:"",draggable:!1,className:"absolute w-full h-full object-cover"}),e.jsxs("div",{className:"flex flex-col mx-3 lg:flex-row w-full lg:max-w-4xl sm:max-w-[60%] max-w-[90%] h-auto bg-white shadow-lg rounded-3xl overflow-hidden",children:[e.jsx("div",{className:"hidden lg:block lg:w-3/4 relative",children:e.jsx("img",{src:"/img/Hero Images/login_main.png",alt:"login",draggable:!1,className:"w-full h-full object-cover"})}),d?e.jsx(Y,{setShowOtpLogin:g}):e.jsxs("div",{className:"w-full lg:w-1/2 p-8 relative bg-[#F5E9FF] flex flex-col justify-center items-center",children:[e.jsx(k,{onClick:()=>m("/"),className:"absolute top-4 left-4 cursor-pointer"}),e.jsx("img",{src:"/img/Background Images/Group 1107.png",alt:"logo",className:"w-28 h-28 mb-4"}),e.jsx("p",{className:"font-bold text-xl mb-2",children:"Enter Mobile Number"}),e.jsx("p",{className:"text-gray-500 text-center mb-6",children:"Enter your 10-digit mobile number to receive the verification code."}),e.jsx(T,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(y),className:"w-full space-y-6",children:[e.jsx(E,{control:i.control,name:"mobile",render:({field:n})=>e.jsxs(C,{children:[e.jsx(R,{className:"mb-2",children:"Mobile Number"}),e.jsx(I,{children:e.jsx(_,{country:"in",preferredCountries:["in","us","sa","ae"],enableSearch:!0,placeholder:"Valid mobile number",value:n.value,inputStyle:{width:"100%"},buttonStyle:{backgroundColor:"transparent",border:"none"},onChange:(r,a)=>{const t=(a==null?void 0:a.dialCode)||"";let o=r;o.startsWith(t)&&(o=o.slice(t.length)),i.setValue("mobile",`${t}-${o}`),i.setValue("mobile4OTP",o)},inputClass:"w-full p-6 border border-gray-300  rounded"})}),e.jsx(F,{})]})}),e.jsx(L,{type:"submit",disabled:l,variant:"b2bStyle",className:"w-full",size:"b2b",children:l?e.jsx(V,{color:"#ffff",size:20}):" Get Verification Code"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["If you don't have an account,"," ",e.jsx(P,{to:"/register",className:"text-textMain",children:"register here"})]})]})})]})]})]})}export{re as default};
